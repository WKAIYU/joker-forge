import {
  RectangleStackIcon,
  CreditCardIcon,
  SparklesIcon,
  FaceSmileIcon,
  PlayIcon,
  BanknotesIcon,
  ChartBarIcon,
  HandRaisedIcon,
  FireIcon,
} from "@heroicons/react/24/outline";

export interface GameVariable {
  id: string;
  label: string;
  description: string;
  category: string;
  subcategory?: string;
  code: string;
}

export interface GameVariableSubcategory {
  id: string;
  label: string;
  variables: GameVariable[];
}

export interface GameVariableCategory {
  id: string;
  label: string;
  icon: React.ComponentType<{ className?: string }>;
  variables: GameVariable[];
  subcategories?: GameVariableSubcategory[];
}

export const GAME_VARIABLE_CATEGORIES: GameVariableCategory[] = [
  {
    id: "deck",
    label: "牌组 & 卡牌",
    icon: RectangleStackIcon,
    variables: [
      {
        id: "cards_in_deck",
        label: "牌组中的卡牌数",
        description: "当前牌组堆中的卡牌数量",
        category: "deck",
        code: "#(G.deck and G.deck.cards or {})",
      },
      {
        id: "total_playing_cards",
        label: "总游戏卡牌数",
        description: "游戏中的总游戏卡牌数量",
        category: "deck",
        code: "#(G.playing_cards or {})",
      },
      {
        id: "current_hand_size",
        label: "当前手牌大小",
        description: "当前手牌大小",
        category: "deck",
        code: "(G.hand and G.hand.config.card_limit or 0)",
      },
      {
        id: "cards_removed_from_deck",
        label: "从牌组移除的卡牌数",
        description: "从起始牌组中移除的卡牌数量",
        category: "deck",
        code: "(G.GAME.starting_deck_size - #(G.playing_cards or {}))",
      },
      {
        id: "cards_in_hand",
        label: "手牌中的卡牌数",
        description: "当前手牌中的卡牌数量",
        category: "deck",
        code: "#(G.hand and G.hand.cards or {})",
      },
      {
        id: "cards_in_discard",
        label: "弃牌堆中的卡牌数",
        description: "弃牌堆中的卡牌数量",
        category: "deck",
        code: "#(G.discard and G.discard.cards or {})",
      },
    ],
    subcategories: [
      {
        id: "hand_analysis",
        label: "手牌分析",
        variables: [
          {
            id: "lowest_rank_in_hand",
            label: "手牌最低点数",
            description: "手牌中最低卡牌的点数值",
            category: "deck",
            subcategory: "hand_analysis",
            code: "(function() local min = 14; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id < min then min = card.base.id end end; return min end)()",
          },
          {
            id: "highest_rank_in_hand",
            label: "手牌最高点数",
            description: "手牌中最高卡牌的点数值",
            category: "deck",
            subcategory: "hand_analysis",
            code: "(function() local max = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id > max then max = card.base.id end end; return max end)()",
          },
        ],
      },
      {
        id: "deck_composition_ranks",
        label: "牌组构成 - 点数",
        variables: [
          {
            id: "twos_in_deck",
            label: "牌组中2的数量",
            description: "完整牌组中2的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 2 then count = count + 1 end end; return count end)()",
          },
          {
            id: "threes_in_deck",
            label: "牌组中3的数量",
            description: "完整牌组中3的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 3 then count = count + 1 end end; return count end)()",
          },
          {
            id: "fours_in_deck",
            label: "牌组中4的数量",
            description: "完整牌组中4的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 4 then count = count + 1 end end; return count end)()",
          },
          {
            id: "fives_in_deck",
            label: "牌组中5的数量",
            description: "完整牌组中5的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 5 then count = count + 1 end end; return count end)()",
          },
          {
            id: "sixes_in_deck",
            label: "牌组中6的数量",
            description: "完整牌组中6的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 6 then count = count + 1 end end; return count end)()",
          },
          {
            id: "sevens_in_deck",
            label: "牌组中7的数量",
            description: "完整牌组中7的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 7 then count = count + 1 end end; return count end)()",
          },
          {
            id: "eights_in_deck",
            label: "牌组中8的数量",
            description: "完整牌组中8的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 8 then count = count + 1 end end; return count end)()",
          },
          {
            id: "nines_in_deck",
            label: "牌组中9的数量",
            description: "完整牌组中9的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 9 then count = count + 1 end end; return count end)()",
          },
          {
            id: "tens_in_deck",
            label: "牌组中10的数量",
            description: "完整牌组中10的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 10 then count = count + 1 end end; return count end)()",
          },
          {
            id: "jacks_in_deck",
            label: "牌组中J的数量",
            description: "完整牌组中J的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 11 then count = count + 1 end end; return count end)()",
          },
          {
            id: "queens_in_deck",
            label: "牌组中Q的数量",
            description: "完整牌组中Q的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 12 then count = count + 1 end end; return count end)()",
          },
          {
            id: "kings_in_deck",
            label: "牌组中K的数量",
            description: "完整牌组中K的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 13 then count = count + 1 end end; return count end)()",
          },
          {
            id: "aces_in_deck",
            label: "牌组中A的数量",
            description: "完整牌组中A的数量",
            category: "deck",
            subcategory: "deck_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.id == 14 then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "deck_composition_suits",
        label: "牌组构成 - 花色",
        variables: [
          {
            id: "spades_in_deck",
            label: "牌组中黑桃的数量",
            description: "完整牌组中黑桃的数量",
            category: "deck",
            subcategory: "deck_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.suit == 'Spades' then count = count + 1 end end; return count end)()",
          },
          {
            id: "hearts_in_deck",
            label: "牌组中红桃的数量",
            description: "完整牌组中红桃的数量",
            category: "deck",
            subcategory: "deck_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.suit == 'Hearts' then count = count + 1 end end; return count end)()",
          },
          {
            id: "diamonds_in_deck",
            label: "牌组中方块的数量",
            description: "完整牌组中方块的数量",
            category: "deck",
            subcategory: "deck_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.suit == 'Diamonds' then count = count + 1 end end; return count end)()",
          },
          {
            id: "clubs_in_deck",
            label: "牌组中梅花的数量",
            description: "完整牌组中梅花的数量",
            category: "deck",
            subcategory: "deck_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.base.suit == 'Clubs' then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "deck_composition_enhancements",
        label: "牌组构成 - 增强",
        variables: [
          {
            id: "bonus_cards_in_deck",
            label: "牌组中奖励卡的数量",
            description: "完整牌组中奖励卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_bonus') then count = count + 1 end end; return count end)()",
          },
          {
            id: "mult_cards_in_deck",
            label: "牌组中倍率卡的数量",
            description: "完整牌组中倍率卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_mult') then count = count + 1 end end; return count end)()",
          },
          {
            id: "wild_cards_in_deck",
            label: "牌组中万能卡的数量",
            description: "完整牌组中万能卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_wild') then count = count + 1 end end; return count end)()",
          },
          {
            id: "glass_cards_in_deck",
            label: "牌组中玻璃卡的数量",
            description: "完整牌组中玻璃卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_glass') then count = count + 1 end end; return count end)()",
          },
          {
            id: "steel_cards_in_deck",
            label: "牌组中钢铁卡的数量",
            description: "完整牌组中钢铁卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_steel') then count = count + 1 end end; return count end)()",
          },
          {
            id: "stone_cards_in_deck",
            label: "牌组中石头卡的数量",
            description: "完整牌组中石头卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_stone') then count = count + 1 end end; return count end)()",
          },
          {
            id: "gold_cards_in_deck",
            label: "牌组中黄金卡的数量",
            description: "完整牌组中黄金卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_gold') then count = count + 1 end end; return count end)()",
          },
          {
            id: "lucky_cards_in_deck",
            label: "牌组中幸运卡的数量",
            description: "完整牌组中幸运卡的数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if SMODS.has_enhancement(card, 'm_lucky') then count = count + 1 end end; return count end)()",
          },
          {
            id: "enhanced_cards_in_deck",
            label: "牌组中增强卡的数量",
            description: "完整牌组中增强卡的总数量",
            category: "deck",
            subcategory: "deck_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if next(SMODS.get_enhancements(card)) then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "deck_composition_editions",
        label: "牌组构成 - 版本",
        variables: [
          {
            id: "foil_cards_in_deck",
            label: "牌组中闪卡的数量",
            description: "完整牌组中闪卡的数量",
            category: "deck",
            subcategory: "deck_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.edition and card.edition.foil then count = count + 1 end end; return count end)()",
          },
          {
            id: "holographic_cards_in_deck",
            label: "牌组中全息卡的数量",
            description: "完整牌组中全息卡的数量",
            category: "deck",
            subcategory: "deck_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.edition and card.edition.holo then count = count + 1 end end; return count end)()",
          },
          {
            id: "polychrome_cards_in_deck",
            label: "牌组中炫彩卡的数量",
            description: "完整牌组中炫彩卡的数量",
            category: "deck",
            subcategory: "deck_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.edition and card.edition.polychrome then count = count + 1 end end; return count end)()",
          },
          {
            id: "negative_cards_in_deck",
            label: "牌组中负片卡的数量",
            description: "完整牌组中负片卡的数量",
            category: "deck",
            subcategory: "deck_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.edition and card.edition.negative then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "deck_composition_seals",
        label: "牌组构成 - 封印",
        variables: [
          {
            id: "gold_sealed_cards_in_deck",
            label: "牌组中黄金封印卡的数量",
            description: "完整牌组中黄金封印卡的数量",
            category: "deck",
            subcategory: "deck_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.seal == 'Gold' then count = count + 1 end end; return count end)()",
          },
          {
            id: "red_sealed_cards_in_deck",
            label: "牌组中红色封印卡的数量",
            description: "完整牌组中红色封印卡的数量",
            category: "deck",
            subcategory: "deck_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.seal == 'Red' then count = count + 1 end end; return count end)()",
          },
          {
            id: "blue_sealed_cards_in_deck",
            label: "牌组中蓝色封印卡的数量",
            description: "完整牌组中蓝色封印卡的数量",
            category: "deck",
            subcategory: "deck_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.seal == 'Blue' then count = count + 1 end end; return count end)()",
          },
          {
            id: "purple_sealed_cards_in_deck",
            label: "牌组中紫色封印卡的数量",
            description: "完整牌组中紫色封印卡的数量",
            category: "deck",
            subcategory: "deck_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.playing_cards or {}) do if card.seal == 'Purple' then count = count + 1 end end; return count end)()",
          },
        ],
      },
    ],
  },{
    id: "scoring",
    label: "得分",
    icon: FireIcon,
    variables: [],
    subcategories: [
      {
        id: "chips",
        label: "筹码",
        variables: [
          {
            id: "blind_chip_req",
            label: "盲注筹码需求",
            description: "当前盲注的筹码需求",
            category: "scoring",
            subcategory: "chips",
            code: "G.GAME.blind.chips"
          },
          {
            id: "current_chip_total",
            label: "当前筹码总数",
            description: "当前已获得用于满足盲注需求的筹码数量",
            category: "scoring",
            subcategory: "chips",
            code: "G.GAME.chips"
          },
          {
            id: "initial_scoring_chips",
            label: "初始得分筹码",
            description: "所出扑克手牌的初始筹码数量",
            category: "scoring",
            subcategory: "chips",
            code: "G.GAME.current_round.current_hand.chips"
          },
          {
            id: "current_scoring_chips",
            label: "当前得分筹码",
            description: "当前得分中的筹码数量",
            category: "scoring",
            subcategory: "chips",
            code: "hand_chips"
          },
          {
            id: "cumulative_chips",
            label: "累计筹码",
            description: "所有得分卡的累计筹码总数",
            category: "scoring",
            subcategory: "chips",
            code: "(function() local chips_sum = 0; for _, playing_card in pairs(context.scoring_hand or {}) do chips_sum = chips_sum + playing_card.base.nominal end; return chips_sum end)"
          },
        ],
      },
      {
        id: "mult",
        label: "倍数",
        variables: [
          {
            id: "initial_scoring_mult",
            label: "初始得分倍数",
            description: "所出扑克手牌的初始倍数数量",
            category: "scoring",
            subcategory: "mult",
            code: "G.GAME.current_round.current_hand.mult"
          },
          {
            id: "current_scoring_mult",
            label: "当前得分倍数",
            description: "当前得分中的倍数数量",
            category: "scoring",
            subcategory: "mult",
            code: "mult"
          },
          {
            id: "highest_card_mult",
            label: "最高卡牌倍数",
            description: "手牌中最高点数卡牌的倍数值",
            category: "scoring",
            subcategory: "mult",
            code: "(function() local max = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id > max then max = card.base.id end end; return max end)()",
          },
          {
            id: "lowest_card_mult",
            label: "最低卡牌倍数",
            description: "手牌中最低点数卡牌的倍数值",
            category: "scoring",
            subcategory: "mult",
            code: "(function() local min = 14; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id < min then min = card.base.id end end; return min end)()",
          },
        ],
      },
    ],
  },
  {
    id: "hand",
    label: "手牌",
    icon: HandRaisedIcon,
    variables: [],
    subcategories: [
      {
        id: "hand_composition_ranks",
        label: "手牌构成 - 点数",
        variables: [
          {
            id: "twos_in_hand",
            label: "手牌中2的数量",
            description: "手牌中2的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 2 then count = count + 1 end end; return count end)()",
          },
          {
            id: "threes_in_hand",
            label: "手牌中3的数量",
            description: "手牌中3的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 3 then count = count + 1 end end; return count end)()",
          },
          {
            id: "fours_in_hand",
            label: "手牌中4的数量",
            description: "手牌中4的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 4 then count = count + 1 end end; return count end)()",
          },
          {
            id: "fives_in_hand",
            label: "手牌中5的数量",
            description: "手牌中5的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 5 then count = count + 1 end end; return count end)()",
          },
          {
            id: "sixes_in_hand",
            label: "手牌中6的数量",
            description: "手牌中6的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 6 then count = count + 1 end end; return count end)()",
          },
          {
            id: "sevens_in_hand",
            label: "手牌中7的数量",
            description: "手牌中7的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 7 then count = count + 1 end end; return count end)()",
          },
          {
            id: "eights_in_hand",
            label: "手牌中8的数量",
            description: "手牌中8的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 8 then count = count + 1 end end; return count end)()",
          },
          {
            id: "nines_in_hand",
            label: "手牌中9的数量",
            description: "手牌中9的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 9 then count = count + 1 end end; return count end)()",
          },
          {
            id: "tens_in_hand",
            label: "手牌中10的数量",
            description: "手牌中10的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 10 then count = count + 1 end end; return count end)()",
          },
          {
            id: "jacks_in_hand",
            label: "手牌中J的数量",
            description: "手牌中J的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 11 then count = count + 1 end end; return count end)()",
          },
          {
            id: "queens_in_hand",
            label: "手牌中Q的数量",
            description: "手牌中Q的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 12 then count = count + 1 end end; return count end)()",
          },
          {
            id: "kings_in_hand",
            label: "手牌中K的数量",
            description: "手牌中K的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 13 then count = count + 1 end end; return count end)()",
          },
          {
            id: "aces_in_hand",
            label: "手牌中A的数量",
            description: "手牌中A的数量",
            category: "hand",
            subcategory: "hand_composition_ranks",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.id == 14 then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "hand_composition_suits",
        label: "手牌构成 - 花色",
        variables: [
          {
            id: "spades_in_hand",
            label: "手牌中黑桃的数量",
            description: "手牌中黑桃的数量",
            category: "hand",
            subcategory: "hand_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.suit == 'Spades' then count = count + 1 end end; return count end)()",
          },
          {
            id: "hearts_in_hand",
            label: "手牌中红桃的数量",
            description: "手牌中红桃的数量",
            category: "hand",
            subcategory: "hand_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.suit == 'Hearts' then count = count + 1 end end; return count end)()",
          },
          {
            id: "diamonds_in_hand",
            label: "手牌中方块的数量",
            description: "手牌中方块的数量",
            category: "hand",
            subcategory: "hand_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.suit == 'Diamonds' then count = count + 1 end end; return count end)()",
          },
          {
            id: "clubs_in_hand",
            label: "手牌中梅花的数量",
            description: "手牌中梅花的的数量",
            category: "hand",
            subcategory: "hand_composition_suits",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.base.suit == 'Clubs' then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "hand_composition_enhancements",
        label: "手牌构成 - 增强",
        variables: [
          {
            id: "bonus_cards_in_hand",
            label: "手牌中奖励卡的数量",
            description: "手牌中奖励卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_bonus') then count = count + 1 end end; return count end)()",
          },
          {
            id: "mult_cards_in_hand",
            label: "手牌中倍率卡的数量",
            description: "手牌中倍率卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_mult') then count = count + 1 end end; return count end)()",
          },
          {
            id: "wild_cards_in_hand",
            label: "手牌中万能卡的数量",
            description: "手牌中万能卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_wild') then count = count + 1 end end; return count end)()",
          },
          {
            id: "glass_cards_in_hand",
            label: "手牌中玻璃卡的数量",
            description: "手牌中玻璃卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_glass') then count = count + 1 end end; return count end)()",
          },
          {
            id: "steel_cards_in_hand",
            label: "手牌中钢铁卡的数量",
            description: "手牌中钢铁卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_steel') then count = count + 1 end end; return count end)()",
          },
          {
            id: "stone_cards_in_hand",
            label: "手牌中石头卡的数量",
            description: "手牌中石头卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_stone') then count = count + 1 end end; return count end)()",
          },
          {
            id: "gold_cards_in_hand",
            label: "手牌中黄金卡的数量",
            description: "手牌中黄金卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_gold') then count = count + 1 end end; return count end)()",
          },
          {
            id: "lucky_cards_in_hand",
            label: "手牌中幸运卡的数量",
            description: "手牌中幸运卡的数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if SMODS.has_enhancement(card, 'm_lucky') then count = count + 1 end end; return count end)()",
          },
          {
            id: "enhanced_cards_in_hand",
            label: "手牌中增强卡的数量",
            description: "手牌中增强卡的总数量",
            category: "hand",
            subcategory: "hand_composition_enhancements",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if next(SMODS.get_enhancements(card)) then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "hand_composition_editions",
        label: "手牌构成 - 版本",
        variables: [
          {
            id: "foil_cards_in_hand",
            label: "手牌中闪卡的数量",
            description: "手牌中闪卡的数量",
            category: "hand",
            subcategory: "hand_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.edition and card.edition.foil then count = count + 1 end end; return count end)()",
          },
          {
            id: "holographic_cards_in_hand",
            label: "手牌中全息卡的数量",
            description: "手牌中全息卡的数量",
            category: "hand",
            subcategory: "hand_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.edition and card.edition.holo then count = count + 1 end end; return count end)()",
          },
          {
            id: "polychrome_cards_in_hand",
            label: "手牌中炫彩卡的数量",
            description: "手牌中炫彩卡的数量",
            category: "hand",
            subcategory: "hand_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.edition and card.edition.polychrome then count = count + 1 end end; return count end)()",
          },
          {
            id: "negative_cards_in_hand",
            label: "手牌中负片卡的数量",
            description: "手牌中负片卡的数量",
            category: "hand",
            subcategory: "hand_composition_editions",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.edition and card.edition.negative then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "hand_composition_seals",
        label: "手牌构成 - 封印",
        variables: [
          {
            id: "gold_sealed_cards_in_hand",
            label: "手牌中黄金封印卡的数量",
            description: "手牌中黄金封印卡的数量",
            category: "hand",
            subcategory: "hand_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.seal == 'Gold' then count = count + 1 end end; return count end)()",
          },
          {
            id: "red_sealed_cards_in_hand",
            label: "手牌中红色封印卡的数量",
            description: "手牌中红色封印卡的数量",
            category: "hand",
            subcategory: "hand_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.seal == 'Red' then count = count + 1 end end; return count end)()",
          },
          {
            id: "blue_sealed_cards_in_hand",
            label: "手牌中蓝色封印卡的数量",
            description: "手牌中蓝色封印卡的数量",
            category: "hand",
            subcategory: "hand_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.seal == 'Blue' then count = count + 1 end end; return count end)()",
          },
          {
            id: "purple_sealed_cards_in_hand",
            label: "手牌中紫色封印卡的数量",
            description: "手牌中紫色封印卡的数量",
            category: "hand",
            subcategory: "hand_composition_seals",
            code: "(function() local count = 0; for _, card in ipairs(G.hand and G.hand.cards or {}) do if card.seal == 'Purple' then count = count + 1 end end; return count end)()",
          },
        ],
      },
    ],
  },
  {
    id: "consumables",
    label: "消耗品",
    icon: CreditCardIcon,
    variables: [
      {
        id: "consumables_held",
        label: "持有的消耗品数量",
        description: "当前持有的消耗品数量",
        category: "consumables",
        code: "#(G.consumeables and G.consumeables.cards or {})",
      },
      {
        id: "consumable_slots",
        label: "消耗品槽位",
        description: "可用的消耗品槽位总数",
        category: "consumables",
        code: "G.consumeables and G.consumeables.config.card_limit or 0",
      },
      {
        id: "free_consumable_slots",
        label: "空闲消耗品槽位",
        description: "空的消耗品槽位数量",
        category: "consumables",
        code: "(G.consumeables and G.consumeables.config.card_limit or 0 - #(G.consumeables and G.consumeables.cards or {}))",
      },
    ],
    subcategories: [
      {
        id: "consumable_usage",
        label: "消耗品使用",
        variables: [
          {
            id: "tarot_cards_used",
            label: "已用塔罗牌数量",
            description: "本轮已使用的塔罗牌总数",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(G.GAME.consumeable_usage_total and G.GAME.consumeable_usage_total.tarot or 0)",
          },
          {
            id: "spectral_cards_used",
            label: "已用幽灵牌数量",
            description: "本轮已使用的幽灵牌总数",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(G.GAME.consumeable_usage_total and G.GAME.consumeable_usage_total.spectral or 0)",
          },
          {
            id: "planet_cards_used",
            label: "已用行星牌数量",
            description: "本轮已使用的行星牌总数",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(G.GAME.consumeable_usage_total and G.GAME.consumeable_usage_total.planet or 0)",
          },
          {
            id: "unique_tarots_used",
            label: "已用独特塔罗牌数量",
            description: "已使用的独特塔罗牌数量",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(function() local count = 0; for k, v in pairs(G.GAME.consumeable_usage) do if v.set == 'Tarot' then count = count + 1 end end; return count end)()",
          },
          {
            id: "unique_planets_used",
            label: "已用独特行星牌数量",
            description: "已使用的独特行星牌数量",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(function() local count = 0; for k, v in pairs(G.GAME.consumeable_usage) do if v.set == 'Planet' then count = count + 1 end end; return count end)()",
          },
          {
            id: "unique_spectrals_used",
            label: "已用独特幽灵牌数量",
            description: "已使用的独特幽灵牌数量",
            category: "consumables",
            subcategory: "consumable_usage",
            code: "(function() local count = 0; for k, v in pairs(G.GAME.consumeable_usage) do if v.set == 'Spectral' then count = count + 1 end end; return count end)()",
          },
        ],
      },
    ],
  },
  {
    id: "jokers",
    label: "小丑牌",
    icon: FaceSmileIcon,
    variables: [],
    subcategories: [
      {
        id: "joker_slots",
        label: "小丑牌槽位",
        variables: [
          {
            id: "joker_count",
            label: "小丑牌数量",
            description: "当前持有的小丑牌数量",
            category: "jokers",
            code: "#(G.jokers and G.jokers.cards or {})",
          },
          {
            id: "joker_slots",
            label: "小丑牌槽位总数",
            description: "可用的小丑牌槽位总数",
            category: "jokers",
            code: "G.jokers and G.jokers.config.card_limit or 0",
          },
          {
            id: "free_joker_slots",
            label: "空闲小丑牌槽位",
            description: "空的小丑牌槽位数量",
            category: "jokers",
            code: "((G.jokers and G.jokers.config.card_limit or 0) - #(G.jokers and G.jokers.cards or {}))",
          },
        ]
      },
      {
        id: "joker_rarities",
        label: "按稀有度分类的小丑牌",
        variables: [
          {
            id: "common_jokers",
            label: "普通小丑牌",
            description: "拥有的普通稀有度小丑牌数量",
            category: "jokers",
            subcategory: "joker_rarities",
            code: "(function() local count = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker.config.center.rarity == 1 then count = count + 1 end end; return count end)()",
          },
          {
            id: "uncommon_jokers",
            label: "罕见小丑牌",
            description: "拥有的罕见稀有度小丑牌数量",
            category: "jokers",
            subcategory: "joker_rarities",
            code: "(function() local count = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker.config.center.rarity == 2 then count = count + 1 end end; return count end)()",
          },
          {
            id: "rare_jokers",
            label: "稀有小丑牌",
            description: "拥有的稀有稀有度小丑牌数量",
            category: "jokers",
            subcategory: "joker_rarities",
            code: "(function() local count = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker.config.center.rarity == 3 then count = count + 1 end end; return count end)()",
          },
          {
            id: "legendary_jokers",
            label: "传说小丑牌",
            description: "拥有的传说稀有度小丑牌数量",
            category: "jokers",
            subcategory: "joker_rarities",
            code: "(function() local count = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker.config.center.rarity == 4 then count = count + 1 end end; return count end)()",
          },
        ],
      },
      {
        id: "joker_economics",
        label: "小丑牌经济",
        variables: [
          {
            id: "self_sell_value",
            label: "此小丑牌售价",
            description: "仅此小丑牌的售价",
            category: "jokers",
            subcategory: "joker_economics",
            code: "(function() for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker == card then return joker.sell_cost end end end)()",
          },
          {
            id: "other_jokers_sell_value",
            label: "其他小丑牌售价",
            description: "所有其他小丑牌的合计售价",
            category: "jokers",
            subcategory: "joker_economics",
            code: "(function() local total = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do if joker ~= card then total = total + joker.sell_cost end end; return total end)()",
          },
          {
            id: "all_jokers_sell_value",
            label: "所有小丑牌售价",
            description: "所有小丑牌的合计售价",
            category: "jokers",
            subcategory: "joker_economics",
            code: "(function() local total = 0; for _, joker in ipairs(G.jokers and G.jokers.cards or {}) do total = total + joker.sell_cost end; return total end)()",
          },
        ],
      },
    ],
  },
  {
    id: "poker_hands",
    label: "扑克手牌",
    icon: PlayIcon,
    variables: [
      {
        id: "current_hand_played_count",
        label: "当前手牌出牌次数",
        description: "当前所出手牌已被出过的次数",
        category: "poker_hands",
        code: "G.GAME.hands[context.scoring_name].played",
      },
      {
        id: "total_hand_levels",
        label: "手牌等级总数",
        description: "所有扑克手牌等级的总和",
        category: "poker_hands",
        code: "(function() local total = 0; for hand, data in pairs(G.GAME.hands) do if data.level >= to_big(1) then total = total + data.level end end; return total end)()",
      },
      {
        id: "hand_levels_above_one",
        label: "超过一级的手牌等级",
        description: "每个手牌总等级减去基础等级",
        category: "poker_hands",
        code: "(function() local total_levels = 0; local total_hands = 0; for hand, data in pairs(G.GAME.hands) do if data.level >= to_big(1) then total_hands = total_hands + 1; total_levels = total_levels + data.level end end; return total_levels - total_hands end)()",
      },
    ],
    subcategories: [
      {
        id: "hand_play_counts",
        label: "手牌出牌次数",
        variables: [
          {
            id: "high_card_played",
            label: "高牌出牌次数",
            description: "高牌已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['High Card'].played",
          },
          {
            id: "pair_played",
            label: "对子出牌次数",
            description: "对子已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Pair'].played",
          },
          {
            id: "two_pair_played",
            label: "两对出牌次数",
            description: "两对已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Two Pair'].played",
          },
          {
            id: "three_of_a_kind_played",
            label: "三条出牌次数",
            description: "三条已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Three of a Kind'].played",
          },
          {
            id: "straight_played",
            label: "顺子出牌次数",
            description: "顺子已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Straight'].played",
          },
          {
            id: "flush_played",
            label: "同花出牌次数",
            description: "同花已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Flush'].played",
          },
          {
            id: "full_house_played",
            label: "葫芦出牌次数",
            description: "葫芦已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Full House'].played",
          },
          {
            id: "four_of_a_kind_played",
            label: "四条出牌次数",
            description: "四条已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Four of a Kind'].played",
          },
          {
            id: "straight_flush_played",
            label: "同花顺出牌次数",
            description: "同花顺已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Straight Flush'].played",
          },
          {
            id: "five_of_a_kind_played",
            label: "五条出牌次数",
            description: "五条已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Five of a Kind'].played",
          },
          {
            id: "flush_house_played",
            label: "同花葫芦出牌次数",
            description: "同花葫芦已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Flush House'].played",
          },
          {
            id: "flush_five_played",
            label: "同花五出牌次数",
            description: "同花五已被出过的次数",
            category: "poker_hands",
            subcategory: "hand_play_counts",
            code: "G.GAME.hands['Flush Five'].played",
          },
        ],
      },
      {
        id: "hand_levels",
        label: "手牌等级",
        variables: [
          {
            id: "high_card_level",
            label: "高牌等级",
            description: "高牌的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['High Card'].level",
          },
          {
            id: "pair_level",
            label: "对子等级",
            description: "对子的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Pair'].level",
          },
          {
            id: "two_pair_level",
            label: "两对等级",
            description: "两对的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Two Pair'].level",
          },
          {
            id: "three_of_a_kind_level",
            label: "三条等级",
            description: "三条的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Three of a Kind'].level",
          },
          {
            id: "straight_level",
            label: "顺子等级",
            description: "顺子的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Straight'].level",
          },
          {
            id: "flush_level",
            label: "同花等级",
            description: "同花的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Flush'].level",
          },
          {
            id: "full_house_level",
            label: "葫芦等级",
            description: "葫芦的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Full House'].level",
          },
          {
            id: "four_of_a_kind_level",
            label: "四条等级",
            description: "四条的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Four of a Kind'].level",
          },
          {
            id: "straight_flush_level",
            label: "同花顺等级",
            description: "同花顺的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Straight Flush'].level",
          },
          {
            id: "five_of_a_kind_level",
            label: "五条等级",
            description: "五条的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Five of a Kind'].level",
          },
          {
            id: "flush_house_level",
            label: "同花葫芦等级",
            description: "同花葫芦的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Flush House'].level",
          },
          {
            id: "flush_five_level",
            label: "同花五等级",
            description: "同花五的当前等级",
            category: "poker_hands",
            subcategory: "hand_levels",
            code: "G.GAME.hands['Flush Five'].level",
          },
          {
            id: "most_played_hand_level",
            label: "最常出手牌等级",
            description: "最频繁出手牌的等级",
            category: "poker_hands",
            subcategory: "hand_analytics",
            code: "(function() local most_played = 0; local most_played_hand = ''; for hand, data in pairs(G.GAME.hands) do if data.played > most_played then most_played = data.played; most_played_hand = hand end end; return most_played_hand ~= '' and G.GAME.hands[most_played_hand].level or 0 end)()",
          },
          {
            id: "least_played_hand_level",
            label: "最少出手牌等级",
            description: "最不频繁出手牌的等级",
            category: "poker_hands",
            subcategory: "hand_analytics",
            code: "(function() local least_played = math.huge; local least_played_hand = ''; for hand, data in pairs(G.GAME.hands) do if data.played < least_played then least_played = data.played; least_played_hand = hand end end; return least_played_hand ~= '' and G.GAME.hands[least_played_hand].level or 0 end)()",
          },
          {
            id: "most_recent_hand_level",
            label: "最近出手牌等级",
            description: "最近所出手牌的等级",
            category: "poker_hands",
            subcategory: "hand_analytics",
            code: "(G.GAME.last_hand_played and G.GAME.hands[G.GAME.last_hand_played] and G.GAME.hands[G.GAME.last_hand_played].level or 0)",
          },
        ],
      },
    ],
  },
  {
    id: "game_state",
    label: "游戏状态",
    icon: ChartBarIcon,
    variables: [
      {
        id: "current_ante",
        label: "当前盲注等级",
        description: "当前盲注等级",
        category: "game_state",
        code: "G.GAME.round_resets.ante",
      },
      {
        id: "current_money",
        label: "当前金钱",
        description: "当前金钱数量",
        category: "game_state",
        code: "G.GAME.dollars",
      },
      {
        id: "hands_remaining",
        label: "剩余手牌数",
        description: "本轮剩余手牌数量",
        category: "game_state",
        code: "G.GAME.current_round.hands_left",
      },
      {
        id: "discards_remaining",
        label: "剩余弃牌数",
        description: "本轮剩余弃牌数量",
        category: "game_state",
        code: "G.GAME.current_round.discards_left",
      },
      {
        id: "hands_played_this_round",
        label: "本轮已出手牌数",
        description: "本轮已出手牌数量",
        category: "game_state",
        code: "G.GAME.current_round.hands_played",
      },
      {
        id: "discards_used_this_round",
        label: "本轮已用弃牌数",
        description: "本轮已用弃牌数量",
        category: "game_state",
        code: "G.GAME.current_round.discards_used",
      },
      {
        id: "blinds_skipped",
        label: "跳过的盲注数",
        description: "本轮跳过的盲注总数",
        category: "game_state",
        code: "G.GAME.skips",
      },
      {
        id: "base_hands_per_round",
        label: "每轮基础手牌数",
        description: "每轮基础手牌数量",
        category: "game_state",
        code: "G.GAME.round_resets.hands",
      },
      {
        id: "base_discards_per_round",
        label: "每轮基础弃牌数",
        description: "每轮基础弃牌数量",
        category: "game_state",
        code: "G.GAME.round_resets.discards",
      },
    ],
  },
  {
    id: "money_thresholds",
    label: "金钱阈值",
    icon: BanknotesIcon,
    variables: [],
    subcategories: [
      {
        id: "money_intervals",
        label: "金钱间隔",
        variables: [
          {
            id: "money_per_5",
            label: "金钱 ÷ 5",
            description: "当前金钱除以5（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 5))",
          },
          {
            id: "money_per_10",
            label: "金钱 ÷ 10",
            description: "当前金钱除以10（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 10))",
          },
          {
            id: "money_per_15",
            label: "金钱 ÷ 15",
            description: "当前金钱除以15（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 15))",
          },
          {
            id: "money_per_20",
            label: "金钱 ÷ 20",
            description: "当前金钱除以20（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 20))",
          },
          {
            id: "money_per_25",
            label: "金钱 ÷ 25",
            description: "当前金钱除以25（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 25))",
          },
          {
            id: "money_per_30",
            label: "金钱 ÷ 30",
            description: "当前金钱除以30（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 30))",
          },
          {
            id: "money_per_40",
            label: "金钱 ÷ 40",
            description: "当前金钱除以40（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 40))",
          },
          {
            id: "money_per_50",
            label: "金钱 ÷ 50",
            description: "当前金钱除以50（向下取整）",
            category: "money_thresholds",
            subcategory: "money_intervals",
            code: "math.floor(lenient_bignum(G.GAME.dollars / 50))",
          },
        ],
      },
    ],
  },
  {
    id: "special",
    label: "特殊",
    icon: SparklesIcon,
    variables: [],
    subcategories: [
      {
        id: "hand_position",
        label: "手牌位置",
        variables: [
          {
            id: "leftmost_card_rank",
            label: "最左侧卡牌点数",
            description: "手牌中最左侧卡牌的点数",
            category: "special",
            subcategory: "hand_position",
            code: "(G.hand and G.hand.cards[1] and G.hand.cards[1].base.id or 0)",
          },
          {
            id: "rightmost_card_rank",
            label: "最右侧卡牌点数",
            description: "手牌中最右侧卡牌的点数",
            category: "special",
            subcategory: "hand_position",
            code: "(G.hand and G.hand.cards[#G.hand.cards] and G.hand.cards[#G.hand.cards].base.id or 0)",
          },
        ],
      },
      {
        id: "time_based",
        label: "基于时间",
        variables: [
          {
            id: "current_seconds",
            label: "当前秒数",
            description: "当前秒数 (0-59)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).sec',
          },
          {
            id: "current_minutes",
            label: "当前分钟",
            description: "当前分钟 (0-59)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).min',
          },
          {
            id: "current_hours",
            label: "当前小时",
            description: "当前小时 (0-23)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).hour',
          },
          {
            id: "current_day",
            label: "当前日期",
            description: "当前月份中的日期 (1-31)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).day',
          },
          {
            id: "current_month",
            label: "当前月份",
            description: "当前月份 (1-12)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).month',
          },
          {
            id: "current_year",
            label: "当前年份",
            description: "当前年份（还能怎么描述呢）",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).year',
          },
          {
            id: "current_year_day",
            label: "当前年份天数",
            description: "当前年份中的天数 (1-365)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).yday',
          },
          {
            id: "current_week_day",
            label: "当前星期几",
            description: "当前星期几，其中1是星期日 (1-7)",
            category: "special",
            subcategory: "time_based",
            code: 'os.date("*t", os.time()).wday',
          },
        ],
      },
    ],
  },
];

export const getAllGameVariables = (): GameVariable[] => {
  const allVariables: GameVariable[] = [];

  GAME_VARIABLE_CATEGORIES.forEach((category) => {
    allVariables.push(...category.variables);
    if (category.subcategories) {
      category.subcategories.forEach((subcategory) => {
        allVariables.push(...subcategory.variables);
      });
    }
  });

  return allVariables;
};

export const getGameVariableById = (id: string): GameVariable | undefined => {
  return getAllGameVariables().find((variable) => variable.id === id);
};

export const getGameVariablesByCategory = (
  categoryId: string
): GameVariable[] => {
  const category = GAME_VARIABLE_CATEGORIES.find(
    (cat) => cat.id === categoryId
  );
  return category ? category.variables : [];
};

export const getGameVariablesBySubcategory = (
  categoryId: string,
  subcategoryId: string
): GameVariable[] => {
  const category = GAME_VARIABLE_CATEGORIES.find(
    (cat) => cat.id === categoryId
  );
  if (!category?.subcategories) return [];

  const subcategory = category.subcategories.find(
    (sub) => sub.id === subcategoryId
  );
  return subcategory ? subcategory.variables : [];
};
